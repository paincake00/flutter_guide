
## MCP сервер — что это такое

- **MCP сервер** = отдельное приложение (обычно процесс), которое реализует протокол **Model Context Protocol**.

- Оно описывает свои возможности в **JSON-схеме** (например: `listTools`, `queryDatabase`, `searchFiles`).

- Когда агент вызывает функцию, сервер исполняет **свой собственный код** (написанный разработчиками сервера).

По сути это как **REST API**, только стандартизированное специально для LLM/агентов.

## Workflow

1. **Запуск MCP сервера**

MCP сервер крутится как отдельный процесс (например, на Python или Node.js).

Он слушает соединения (по локальному сокету, HTTP, gRPC — в зависимости от реализации).

2. **Агент подключается**

Агент (Semantic Kernel, AutoGen, OpenAI GPTs и т.д.) подключается к MCP серверу.

Спрашивает: _«Какие инструменты ты предоставляешь?»_

MCP отвечает JSON-описанием доступных функций.

3. **LLM решает вызвать функцию**

Например, у MCP есть инструмент:
```json
{
  "name": "queryDatabase",
  "parameters": { "sql": "string" }
}
```

LLM генерирует вызов:
```json
{ "action": "queryDatabase", "sql": "SELECT * FROM users LIMIT 5" }
```

4. **Фреймворк передаёт вызов MCP серверу**

Semantic Kernel / AutoGen отправляет этот JSON MCP серверу.

5. **MCP сервер исполняет реальный код**

Например, у него под капотом `psycopg2` или `sqlalchemy`.

Выполняется SQL, результат оборачивается в JSON.

6. **Результат возвращается агенту**

MCP возвращает что-то вроде:

```json
{
  "result": [
    {"id": 1, "name": "Alice"},
    {"id": 2, "name": "Bob"}
  ]
}
```

Агент вставляет эти данные в ответ пользователю.